SET DB_CLOSE_DELAY -1;         
;              
CREATE USER IF NOT EXISTS SA SALT 'ebfdda26c02f74bb' HASH 'e15cf851c546c823ee777777e831ae3f08df7809182cd6dfa3533b72e8e3860e' ADMIN;            
CREATE SEQUENCE PUBLIC.USER_ID_SEQ START WITH 10 INCREMENT BY 50;              
CREATE SEQUENCE PUBLIC.DOCUMENTO_ID_SEQ START WITH 101 INCREMENT BY 50;        
CREATE SEQUENCE PUBLIC.BENEFICIARIO_ID_SEQ START WITH 101 INCREMENT BY 50;     
CREATE SEQUENCE PUBLIC.ROLE_ID_SEQ START WITH 10 INCREMENT BY 50;              
CREATE MEMORY TABLE PUBLIC."flyway_schema_history"(
    "installed_rank" INT NOT NULL,
    "version" VARCHAR(50),
    "description" VARCHAR(200) NOT NULL,
    "type" VARCHAR(20) NOT NULL,
    "script" VARCHAR(1000) NOT NULL,
    "checksum" INT,
    "installed_by" VARCHAR(100) NOT NULL,
    "installed_on" TIMESTAMP DEFAULT CURRENT_TIMESTAMP() NOT NULL,
    "execution_time" INT NOT NULL,
    "success" BOOLEAN NOT NULL
);         
ALTER TABLE PUBLIC."flyway_schema_history" ADD CONSTRAINT PUBLIC."flyway_schema_history_pk" PRIMARY KEY("installed_rank");     
-- 2 +/- SELECT COUNT(*) FROM PUBLIC."flyway_schema_history";  
INSERT INTO PUBLIC."flyway_schema_history"("installed_rank", "version", "description", "type", "script", "checksum", "installed_by", "installed_on", "execution_time", "success") VALUES
(1, '1', 'create tables', 'SQL', 'V1__create_tables.sql', 1946452520, 'SA', TIMESTAMP '2023-12-22 05:51:43.754', 25, TRUE),
(2, '2', 'insert sample data', 'SQL', 'V2__insert_sample_data.sql', 1412567371, 'SA', TIMESTAMP '2023-12-22 05:51:43.777', 6, TRUE);      
CREATE INDEX PUBLIC."flyway_schema_history_s_idx" ON PUBLIC."flyway_schema_history"("success");
CREATE MEMORY TABLE PUBLIC.USERS(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.USER_ID_SEQ) NOT NULL,
    USERNAME VARCHAR(255) NOT NULL,
    PASSWORD VARCHAR(255) NOT NULL,
    NAME VARCHAR(255) NOT NULL,
    EMAIL VARCHAR(255) NOT NULL,
    ENABLED BOOLEAN NOT NULL,
    LAST_PASSWORD_RESET_DATE TIMESTAMP
);         
ALTER TABLE PUBLIC.USERS ADD CONSTRAINT PUBLIC.CONSTRAINT_4 PRIMARY KEY(ID);   
-- 2 +/- SELECT COUNT(*) FROM PUBLIC.USERS;    
INSERT INTO PUBLIC.USERS(ID, USERNAME, PASSWORD, NAME, EMAIL, ENABLED, LAST_PASSWORD_RESET_DATE) VALUES
(1, 'admin', '$2a$10$zuI3P8hoZNkFGR2dDPW9juA1C1xIHBUNrKMGqjjaEKsLTwjJkKoNa', 'Admin', 'admin@gmail.com', TRUE, TIMESTAMP '2023-12-22 05:51:43.768'),
(2, 'siva', '$2a$10$LskLrNP6m.dEpXYjT41lRePseXJEjhd6.sPH2Z5GbbShtaFRWoeYq', 'Siva', 'siva@gmail.com', TRUE, TIMESTAMP '2023-12-22 05:51:43.768'); 
CREATE MEMORY TABLE PUBLIC.ROLES(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.ROLE_ID_SEQ) NOT NULL,
    NAME VARCHAR(255) NOT NULL
);        
ALTER TABLE PUBLIC.ROLES ADD CONSTRAINT PUBLIC.CONSTRAINT_4A PRIMARY KEY(ID);  
-- 2 +/- SELECT COUNT(*) FROM PUBLIC.ROLES;    
INSERT INTO PUBLIC.ROLES(ID, NAME) VALUES
(1, 'ROLE_USER'),
(2, 'ROLE_ADMIN'); 
CREATE MEMORY TABLE PUBLIC.USER_ROLE(
    USER_ID BIGINT,
    ROLE_ID BIGINT
);
-- 3 +/- SELECT COUNT(*) FROM PUBLIC.USER_ROLE;
INSERT INTO PUBLIC.USER_ROLE(USER_ID, ROLE_ID) VALUES
(1, 1),
(2, 1),
(2, 2);  
CREATE MEMORY TABLE PUBLIC.BENEFICIARIO(
    ID BIGINT NOT NULL,
    DT_ATUALICAO TIMESTAMP,
    DT_INCLUSAO TIMESTAMP,
    DT_NASCIMENTO TIMESTAMP,
    NOME VARCHAR(255),
    TELEFONE VARCHAR(255)
);       
ALTER TABLE PUBLIC.BENEFICIARIO ADD CONSTRAINT PUBLIC.CONSTRAINT_7 PRIMARY KEY(ID);            
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.BENEFICIARIO;             
INSERT INTO PUBLIC.BENEFICIARIO(ID, DT_ATUALICAO, DT_INCLUSAO, DT_NASCIMENTO, NOME, TELEFONE) VALUES
(1, TIMESTAMP '2023-12-22 05:08:35.188', TIMESTAMP '2023-12-22 05:08:35.188', TIMESTAMP '2023-12-22 05:08:35.188', 'particular', '119123456');            
CREATE MEMORY TABLE PUBLIC.BENEFICIARIO_ROLE(
    BENEFICIARIO_ID BIGINT NOT NULL,
    DOCUMENTO_ID BIGINT NOT NULL
);         
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.BENEFICIARIO_ROLE;        
INSERT INTO PUBLIC.BENEFICIARIO_ROLE(BENEFICIARIO_ID, DOCUMENTO_ID) VALUES
(1, 1);             
CREATE MEMORY TABLE PUBLIC.DOCUMENTO(
    ID BIGINT NOT NULL,
    DESCRICAO VARCHAR(255),
    DT_ATUALICAO TIMESTAMP,
    DT_INCLUSAO TIMESTAMP,
    TIPO_DOCUMENTO VARCHAR(255)
);            
ALTER TABLE PUBLIC.DOCUMENTO ADD CONSTRAINT PUBLIC.CONSTRAINT_D PRIMARY KEY(ID);               
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.DOCUMENTO;
INSERT INTO PUBLIC.DOCUMENTO(ID, DESCRICAO, DT_ATUALICAO, DT_INCLUSAO, TIPO_DOCUMENTO) VALUES
(1, 'nota fiscal', TIMESTAMP '2023-12-22 05:08:35.188', TIMESTAMP '2023-12-22 05:08:35.188', 'fiscal');          
ALTER TABLE PUBLIC.USERS ADD CONSTRAINT PUBLIC.USER_USERNAME_UNIQUE UNIQUE(USERNAME);          
ALTER TABLE PUBLIC.ROLES ADD CONSTRAINT PUBLIC.ROLE_NAME_UNIQUE UNIQUE(NAME);  
ALTER TABLE PUBLIC.USERS ADD CONSTRAINT PUBLIC.USER_EMAIL_UNIQUE UNIQUE(EMAIL);
ALTER TABLE PUBLIC.BENEFICIARIO ADD CONSTRAINT PUBLIC.UK_9HAMQ99IPFXM527LF6Y0D5IT7 UNIQUE(NOME);               
ALTER TABLE PUBLIC.USER_ROLE ADD CONSTRAINT PUBLIC.FKT7E7DJP752SQN6W22I6OCQY6Q FOREIGN KEY(ROLE_ID) REFERENCES PUBLIC.ROLES(ID) NOCHECK;       
ALTER TABLE PUBLIC.USER_ROLE ADD CONSTRAINT PUBLIC.CONSTRAINT_BC FOREIGN KEY(ROLE_ID) REFERENCES PUBLIC.ROLES(ID) NOCHECK;     
ALTER TABLE PUBLIC.BENEFICIARIO_ROLE ADD CONSTRAINT PUBLIC.FKC5145GXUVVF8J28MNSHG0495C FOREIGN KEY(BENEFICIARIO_ID) REFERENCES PUBLIC.BENEFICIARIO(ID) NOCHECK;
ALTER TABLE PUBLIC.USER_ROLE ADD CONSTRAINT PUBLIC.FKJ345GK1BOVQVFAME88RCX7YYX FOREIGN KEY(USER_ID) REFERENCES PUBLIC.USERS(ID) NOCHECK;       
ALTER TABLE PUBLIC.BENEFICIARIO_ROLE ADD CONSTRAINT PUBLIC.FK86YFQXVEGPH8QDRTN8FEGBQIB FOREIGN KEY(DOCUMENTO_ID) REFERENCES PUBLIC.DOCUMENTO(ID) NOCHECK;      
ALTER TABLE PUBLIC.USER_ROLE ADD CONSTRAINT PUBLIC.CONSTRAINT_B FOREIGN KEY(USER_ID) REFERENCES PUBLIC.USERS(ID) NOCHECK;      
